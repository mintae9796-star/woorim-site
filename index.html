<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" id="viewportMeta" content="width=device-width, initial-scale=1" />
  <title>ë¹„ë‹í•˜ìš°ìŠ¤ ì‹œê³µÂ·ê²¬ì  | ìš°ë¦¼ë¹„ë‹í•˜ìš°ìŠ¤ â€” ë§ì¶¤ ì„¤ê³„Â·ì‹œê³µÂ·ë³´ìˆ˜</title>
  <meta name="description" content="ë¹„ë‹í•˜ìš°ìŠ¤ ì‹œê³µÂ·ê²¬ì  ì „ë¬¸. í˜„ì¥ ë§ì¶¤ ì„¤ê³„Â·ì‹œê³µÂ·ë³´ìˆ˜, ìë™ê°œí/ì—°ë™/ë‹¨ë™ ì „ë¬¸. ì‹œê³µì‚¬ë¡€Â·ê°€ê²©Â·ê³ ê°í›„ê¸°ë¥¼ í™•ì¸í•˜ê³  ë°”ë¡œ ìƒë‹´ ë°›ìœ¼ì„¸ìš”.">
  <link rel="canonical" href="https://www.woorimhouse.com/">
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">

  <!-- Open Graph / ë„¤ì´ë²„Â·ì¹´ì¹´ì˜¤ ë¯¸ë¦¬ë³´ê¸° -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="ë¹„ë‹í•˜ìš°ìŠ¤ ì‹œê³µÂ·ê²¬ì  | ìš°ë¦¼ë¹„ë‹í•˜ìš°ìŠ¤">
  <meta property="og:description" content="ë§ì¶¤ ì„¤ê³„Â·ì‹œê³µÂ·ë³´ìˆ˜ â€” ì‚¬ë¡€Â·ê°€ê²©Â·í›„ê¸° í•œëˆˆì—.">
  <meta property="og:image" href="assets/og/og-1200x630.png">
  <meta property="og:url" content="https://www.woorimhouse.com/">


<!-- íŒŒë¹„ì½˜ -->
  <link rel="apple-touch-icon" sizes="57x57" href="assets/logo/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="assets/logo/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="assets/logo/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="assets/logo/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="assets/logo/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="assets/logo/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="assets/logo/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="assets/logo/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="assets/logo/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="assets/logo/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/logo/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="assets/logo/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/logo/favicon-16x16.png">
  <link rel="manifest" href="assets/logo/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="assets/logo/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

<!-- ë„¤ì´ë²„/êµ¬ê¸€ ì†Œìœ ê¶Œ í™•ì¸ (ë°œê¸‰ë°›ì€ ê°’ìœ¼ë¡œ êµì²´) -->

  
  <style>
    :root{
      --brand:#5A7F71; --brand-ink:#35564a; --accent:#A3B18A;
      --bg:#ffffff; --text:#1f2937; --muted:#6b7280;
      --card:#F8FAF9; --line:#e6eae7;
      --radius:16px; --shadow:0 10px 30px rgba(0,0,0,0.08);
      --container:1040px;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:"Pretendard",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.7;word-break:keep-all}
    a{color:var(--brand);text-decoration:none}
    img{max-width:100%;height:auto;border-radius:12px;display:block}
    .container{max-width:var(--container);margin:0 auto;padding:0 16px}

    /* Header */
    header{position:sticky;top:0;z-index:40;background:rgba(255,255,255,.9);backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid var(--line)}
    .nav{display:flex;align-items:center;justify-content:space-between;min-height:56px}
    .logo{display:flex;align-items:center;gap:10px;font-weight:900;color:var(--text)}
    .logo-badge{width:28px;height:28px;border-radius:10px;background:var(--brand);display:grid;place-items:center;color:#fff;font-size:.9rem}
    .btn{display:inline-flex;gap:8px;align-items:center;justify-content:center;padding:12px 16px;border-radius:999px;background:var(--brand);color:#fff;font-weight:800;border:0;cursor:pointer;box-shadow:var(--shadow);transition:.18s}
    .btn:hover{filter:brightness(.96)}
    .btn.alt{background:#fff;color:var(--brand);border:2px solid var(--brand)}

    /* Hero */
    .hero{padding:58px 0;background:radial-gradient(900px 230px at 50% -120px, rgba(90,127,113,.10), transparent 60%)}
    .hero h1{font-size:28px;line-height:1.25;margin:0 0 10px}
    .hero .lead{color:var(--muted);margin:0 0 16px}
    .tags{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 16px}
    .tag{padding:6px 10px;background:#fff;border:1px solid var(--line);border-radius:999px;color:#253528}

    /* Sections */
    section{padding:46px 0}
    h2{font-size:22px;margin:0 0 14px;color:#253528}

    /* Cases Carousel (drag + auto, no visible scrollbar) */
    #cases .carousel{position:relative}
    #cases .slides{
      display:flex; gap:12px; overflow:auto; scroll-snap-type:x mandatory;
      -webkit-overflow-scrolling:touch; padding-bottom:6px; scroll-behavior:smooth;
      -ms-overflow-style:none; scrollbar-width:none;
    }
    #cases .slides::-webkit-scrollbar{ display:none }
    #cases .slides .card{flex:0 0 88%;scroll-snap-align:start;background:#fff;border:1px solid var(--line);border-radius:14px;overflow:hidden}
    @media(min-width:720px){ #cases .slides .card{flex-basis:48%} }
    @media(min-width:1024px){ #cases .slides .card{flex-basis:32%} }
    .case-thumb{aspect-ratio:16/9;background:#eee}
    .case-thumb img{width:100%;height:100%;object-fit:cover;border-radius:0}
    .case-body{padding:12px 14px}
    .case-title{margin:0 0 6px;font-weight:900}
    .case-sub{margin:0;color:var(--muted)}

    /* Pricing */
    .grid{display:grid;gap:12px}
    .grid-2{grid-template-columns:1fr}
    .grid-3{grid-template-columns:1fr}
    @media(min-width:720px){ .grid-2{grid-template-columns:1fr 1fr} .grid-3{grid-template-columns:1fr 1fr 1fr} }
    .price{background:#fff;border:1px solid var(--line);border-radius:14px;overflow:hidden}
    .price .head{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:#fff}
    .price h3{margin:0;font-size:16px;color:#253528}
    .price .num{font-weight:900;color:#35564a;font-size:20px}
    .price .body{padding:12px 16px;display:grid;gap:8px}
    .check{display:flex;gap:8px;align-items:center}
    .check:before{content:"âœ”";color:#35564a;font-weight:900}

    /* Reviews (pretty cards + load more) */
    .reviews{ display:grid; gap:12px }
    @media(min-width:720px){ .reviews{ grid-template-columns:1fr 1fr } }
    .review.card{
      background:#fff;border:1px solid var(--line);border-radius:14px;overflow:hidden;
      display:grid;grid-template-columns:96px 1fr;
    }
    .review .thumb{ background:#f1f5f9; width:96px; height:100%; display:grid; place-items:center }
    .review .thumb img{ width:100%; height:100%; object-fit:cover; border-radius:0 }
    .review .body{ padding:12px 14px }
    .review .title{ margin:0 0 6px; font-weight:900; color:#253528 }
    .review .meta{ color:var(--muted); font-size:12px; margin:0 0 8px }
    .stars{ display:inline-flex; gap:2px; font-size:14px; color:#f59e0b; vertical-align:middle }
    #moreReviewsWrap{display:flex;justify-content:center;margin-top:8px}

    /* Form (mobile-safe) */
    #inquiry{gap:14px;background:#fff;border:1px solid var(--line);border-radius:14px;padding:14px}
    #inquiry label{display:grid;gap:6px;font-weight:600;min-width:0}
    #inquiry label span{font-size:13px;color:var(--muted)}
    #inquiry input,#inquiry textarea{
      width:100%;min-width:0;padding:12px 14px;border:1px solid var(--line);
      border-radius:12px;background:#fff;font:inherit;outline:none;transition:border-color .2s, box-shadow .2s
    }
    #inquiry textarea{min-height:120px;resize:vertical}
    #inquiry input:focus,#inquiry textarea:focus{border-color:var(--brand);box-shadow:0 0 0 4px rgba(90,127,113,.12)}
    #inquiry .row-actions{display:flex;gap:8px;flex-wrap:wrap}
    #inquiry .row-actions .btn{flex:1}
    @media(min-width:720px){
      #inquiry{display:grid;grid-template-columns:1fr 1fr}
      #inquiry .full{grid-column:1/-1}
      #inquiry .row-actions{grid-column:1/-1}
    }
    #formStatus{margin:2px 0 0;color:var(--muted);font-size:13px}

    /* FAQ (with minimal chevron SVG) */
    #faqs{display:grid; gap:10px}
    details{
      background:#fff; border:1px solid var(--line); border-radius:14px; overflow:hidden;
      transition:box-shadow .2s, border-color .2s;
      word-break:break-word;
    }
    details[open]{ box-shadow:var(--shadow); border-color:#dfe6e2 }
    summary{
      list-style:none; cursor:pointer; user-select:none; padding:12px 16px;
      display:flex; align-items:center; gap:8px; font-weight:800; color:#253528; outline:none;
    }
    summary::-webkit-details-marker{ display:none }
    .faq-caret{
      width:18px;height:18px; color:#9aa7a0; flex:0 0 18px;
      transition:transform .2s ease, color .2s ease;
    }
    details[open] .faq-caret{ transform:rotate(90deg); color:#5a7f71 }
    .faq-body{ padding:0 16px 14px; color:var(--muted) }
    .faq-body > *:first-child{ margin-top:0 }
    .faq-body > *:last-child{ margin-bottom:0 }

    /* Footer */
    footer{
      border-top:1px solid var(--line);
      background:linear-gradient(180deg,#fff,#f8faf9);
      color:var(--text);
    }
    .footer-wrap{max-width:var(--container); margin:0 auto; padding:28px 16px}
    .footer-grid{ display:grid; gap:18px; grid-template-columns:1fr }
    @media(min-width:720px){ .footer-grid{ grid-template-columns:1.1fr .9fr .9fr } }
    .f-col h4{margin:0 0 10px;color:#253528}
    .f-brand{display:flex; gap:12px; align-items:flex-start}
    .f-logo{min-width:36px;width:36px;height:36px;border-radius:12px;background:var(--brand);color:#fff;display:grid;place-items:center;font-weight:900}
    .f-title{margin:0;font-weight:900}
    .f-lead{margin:2px 0 12px; color:var(--muted); font-size:14px}
    .f-list{list-style:none; padding:0; margin:0; display:grid; gap:8px}
    .f-list a{color:var(--text)}
    .f-list a:hover{color:var(--brand)}
    .f-biz{display:grid; gap:6px; font-size:14px; color:var(--muted)}
    .f-biz b{color:var(--text); font-weight:700}
    .f-bottom{
      display:flex; flex-wrap:wrap; gap:8px; justify-content:space-between;
      align-items:center; margin-top:18px; padding-top:14px; border-top:1px solid var(--line); font-size:13px; color:var(--muted)
    }
    .f-social{display:flex; gap:10px}
    .f-chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border:1px solid var(--line); border-radius:999px; background:#fff;
      color:#35564a; font-weight:700;
    }

    /* Sticky CTA */
    .sticky-cta{position:sticky;bottom:0;z-index:35;background:rgba(255,255,255,.92);backdrop-filter:saturate(180%) blur(10px);border-top:1px solid var(--line);padding:10px}
    .sticky-cta .row{display:flex;gap:8px}
    .sticky-cta .row .btn{flex:1}

    /* Reveal */
    .reveal{opacity:0;transform:translateY(16px);transition:opacity .55s ease, transform .55s ease}
    .reveal.visible{opacity:1;transform:none}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <a class="logo" href="#home"><img src="assets/logo/logo.png" style="height:40px;"></a>
      <a class="btn alt" href="#contact">ë¬´ë£Œ ìƒë‹´</a>
    </div>
  </header>

  <main id="home">
    <!-- Hero -->
    <section class="hero">
      <div class="container">
        <h1 class="reveal" data-cms-key="hero-title">í˜„ì¥ì— ë”± ë§ì¶˜ <span style="color:var(--brand)">ë¹„ë‹í•˜ìš°ìŠ¤</span>,<br>ì„¤ê³„Â·ì‹œê³µÂ·ë³´ìˆ˜ê¹Œì§€ í•œ ë²ˆì—</h1>
        <p class="lead reveal" data-cms-key="hero-lead">ê²¬ì  ë½‘ê¸° ì „, <b>ì‚¬ë¡€Â·ê°€ê²©Â·í›„ê¸°</b>ë§Œ ë¹ ë¥´ê²Œ ë³´ê³  ê²°ì •í•˜ì„¸ìš”.</p>
        <div class="reveal" style="display:flex;gap:10px;flex-wrap:wrap">
          <a class="btn" href="#contact">ë°”ë¡œ ìƒë‹´</a>
          <a class="btn alt" href="#cases">ì‹œê³µì‚¬ë¡€ ë³´ê¸°</a>
        </div>
        <div class="tags reveal">
          <div class="tag">ì„¤ê³„Â·ì‹œê³µÂ·ë³´ìˆ˜</div>
          <div class="tag">ìë™ê°œí</div>
          <div class="tag">ì—°ë™/ë‹¨ë™</div>
        </div>
      </div>
    </section>

    <!-- Cases Carousel -->
    <section id="cases">
      <div class="container">
        <h2 class="reveal" data-cms-key="cases-title">ì‹œê³µì‚¬ë¡€</h2>
        <div class="carousel reveal" id="caseCarousel">
          <div class="slides" id="caseSlides"></div>
        </div>
      </div>
    </section>

    <!-- Pricing -->
    <section id="pricing">
      <div class="container">
        <h2 class="reveal" data-cms-key="pricing-title">ëŒ€ëµ ê²¬ì (ë¶€ê°€ì„¸ ë³„ë„)</h2>
        <div class="grid grid-2 reveal" data-cms-key="pricing-grid">
          <div class="price">
            <div class="head"><h3>ë‹¨ë™ í•˜ìš°ìŠ¤(ì†Œí˜•)</h3><div class="num">â‚©2,000,000 ~</div></div>
            <div class="body">
              <div class="check">ê¸°ì´ˆ ê³µì‚¬ í¬í•¨</div>
              <div class="check">ì¸¡ì°½ ë° í™˜ê¸°ì°½ ê¸°ë³¸í˜•</div>
              <div class="check">ê°„ë‹¨í•œ ë‚´ë¶€ ì„¤ë¹„ í¬í•¨</div>
              <a class="btn" href="#contact" style="margin-top:6px;justify-content:center">ë‚´ í˜„ì¥ ê¸°ì¤€ ê²¬ì  ë°›ê¸°</a>
            </div>
          </div>
          <div class="price">
            <div class="head"><h3>ì—°ë™ í•˜ìš°ìŠ¤(ì¤‘í˜•)</h3><div class="num">â‚©6,500,000 ~</div></div>
            <div class="body">
              <div class="check">êµ¬ì¡° ë³´ê°•/ê¸°ì´ˆ ê°•í™”</div>
              <div class="check">ì¸¡ì°½Â·í™˜ê¸° ìµœì í™”</div>
              <div class="check">ìœ ì§€ê´€ë¦¬ ê°€ì´ë“œ ì œê³µ</div>
              <a class="btn" href="#contact" style="margin-top:6px;justify-content:center">ë‚´ í˜„ì¥ ê¸°ì¤€ ê²¬ì  ë°›ê¸°</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Reviews -->
    <section>
      <div class="container">
        <h2 class="reveal" data-cms-key="reviews-title">ê³ ê° í›„ê¸°</h2>
        <div id="reviews" class="reviews"></div>
        <div id="moreReviewsWrap"></div>
      </div>
    </section>

    <!-- FAQ -->
    <section>
      <div class="container">
        <h2 class="reveal" data-cms-key="faqs-title">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</h2>
        <div id="faqs"></div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact">
      <div class="container">
        <h2 class="reveal" data-cms-key="contact-title">ìƒë‹´ ìš”ì²­</h2>

        <form id="inquiry" class="reveal">
          <label>
            <span>ì´ë¦„</span>
            <input name="name" required placeholder="í™ê¸¸ë™"/>
          </label>
          <label>
            <span>ì—°ë½ì²˜</span>
            <input name="phone" required placeholder="010-0000-0000"/>
          </label>
          <label class="full">
            <span>ë¹„ê³ (ìš”ì²­ì‚¬í•­)</span>
            <textarea name="note" placeholder="ì˜ˆ: ì—°ë™ ì‹ ì¶• / ìë™ê°œí í¬í•¨ / í˜„ì¥ì£¼ì†Œ ë“±"></textarea>
          </label>
          <div class="row-actions">
            <button class="btn" type="submit">ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¡œ ë³´ë‚´ê¸°</button>
          </div>
          <p id="formStatus" class="full"></p>
        </form>

      </div>
    </section>
  </main>

  <!-- Sticky CTA -->
  <div class="sticky-cta">
    <div class="container"><div class="row">
      <a class="btn" href="#contact">ìƒë‹´ ìš”ì²­</a>
      <a class="btn alt" href="#pricing">ê²¬ì </a>
    </div></div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-wrap">
      <div class="footer-grid">
        <div class="f-col">
          <div class="f-brand">
            <div class="f-logo">GH</div>
            <div>
              <h3 class="f-title">ìš°ë¦¼ë¹„ë‹í•˜ìš°ìŠ¤</h3>
              <p class="f-lead">í˜„ì¥ ë§ì¶¤ ì„¤ê³„Â·ì‹œê³µÂ·ë³´ìˆ˜ê¹Œì§€ í•œ ë²ˆì—, ì‚¬ë¡€Â·ê°€ê²©Â·í›„ê¸° í•œ í™”ë©´ì—ì„œ.</p>
              <div class="f-chip">ìƒë‹´ <span id="fPhone">010-9416-3311</span></div>
            </div>
          </div>
        </div>
        <div class="f-col">
          <h4>ë°”ë¡œê°€ê¸°</h4>
          <ul class="f-list">
            <li><a href="#cases">ì‹œê³µì‚¬ë¡€</a></li>
            <li><a href="#pricing">ëŒ€ëµ ê²¬ì </a></li>
            <li><a href="#contact">ìƒë‹´ ìš”ì²­</a></li>
            <li><a id="fBlog" href="#" target="_blank" rel="noopener" style="display:none">ë¸”ë¡œê·¸</a></li>
          </ul>
        </div>
        <div class="f-col">
          <h4>ì‚¬ì—…ì ì •ë³´</h4>
          <div class="f-biz" id="fBiz">
            <div><b>ìƒí˜¸</b> <span id="bizName">â€”</span></div>
            <div><b>ëŒ€í‘œ</b> <span id="bizOwner">â€”</span></div>
            <div><b>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸</b> <span id="bizRegNo">â€”</span></div>
            <div><b>ì£¼ì†Œ</b> <span id="bizAddr">â€”</span></div>
            <div><b>ê¸°íƒ€</b> <span id="bizEtc">â€”</span></div>
          </div>
        </div>
      </div>
      <div class="f-bottom">
        <div>Â© <span id="y"></span> ìš°ë¦¼ë¹„ë‹í•˜ìš°ìŠ¤</div>
        <div class="f-social">
          <a id="fMap" href="#" target="_blank" rel="noopener" style="display:none">ì˜¤ì‹œëŠ” ê¸¸</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Firebase SDK (v10) -->
  <script type="module">
    import { initializeApp, getApps } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import { getFirestore, collection, query, where, orderBy, getDocs, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js";

    // ===== Google Apps Script Web App URL (ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì ì¬) =====
    // â–¶â–¶ ë³¸ì¸ ì›¹ì•± ë°°í¬ URLë¡œ êµì²´í•˜ì„¸ìš”.
    const GAS_WEBAPP_URL = "https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec";

    // ===== Firebase =====
    const firebaseConfig = {
      apiKey: "AIzaSyANNpMdqbnQYPPgyCrR9LyBeM5MD7w77jM",
      authDomain: "woorim-site.firebaseapp.com",
      projectId: "woorim-site",
      storageBucket: "woorim-site.appspot.com",
      messagingSenderId: "1048438590071",
      appId: "1:1048438590071:web:653737eef80b205e57d472"
    };
    const app = getApps()[0] || initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Reveal
    const io = new IntersectionObserver((es)=> es.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target);} }), {threshold:.12});
    document.querySelectorAll('.reveal').forEach(el=> io.observe(el));
    document.getElementById('y').textContent = new Date().getFullYear();

    // Sanitize
    function sanitizeStrict(html=''){
      const ALLOWED = new Set(['B','I','U','STRONG','EM','P','BR','UL','OL','LI','A','SPAN','H1','H2','H3','H4','H5','H6','BLOCKQUOTE','DIV']);
      const box = document.createElement('div'); box.innerHTML = html || '';
      box.querySelectorAll('script, style, iframe, object, embed').forEach(el=>el.remove());
      (function walk(node){
        if(node.nodeType!==1) return; const tag=node.tagName;
        if(!ALLOWED.has(tag)){ const p=node.parentNode; if(!p) return; while(node.firstChild) p.insertBefore(node.firstChild,node); p.removeChild(node); return; }
        let href=''; if(tag==='A'&&node.hasAttribute('href')){ try{ const u=new URL(node.getAttribute('href'), location.origin); if(['http:','https:','mailto:','tel:'].includes(u.protocol)) href=u.toString(); }catch{} }
        [...node.attributes].forEach(a=>node.removeAttribute(a.name)); if(href) node.setAttribute('href', href);
        [...node.children].forEach(walk);
      })(box);
      return box.innerHTML;
    }

    // CMS ì ìš© (ì˜µì…˜)
    const CMS_DOC = doc(db,'cms','home');
    async function applyCmsOnce(){
      try{
        const snap = await getDoc(CMS_DOC); const content = (snap.data()||{}).content||{};
        document.querySelectorAll('[data-cms-key]').forEach(el=>{
          const key = el.getAttribute('data-cms-key'); const val = content?.[key];
          if(typeof val==='string' && val.trim()!==''){
            if(el.tagName==='IMG') el.src = val.trim(); else el.innerHTML = sanitizeStrict(val);
          }
        });
      }catch(e){ console.log('[SAFE] applyCmsOnce:', e.message); }
    }
    applyCmsOnce();

    // ì‚¬ë¡€
    async function loadCases(){
      const list = document.getElementById('caseSlides'); if(!list) return; list.innerHTML='';
      const col = collection(db,'cases'); let items=[];
      try{
        const q = query(col, where('published','==', true), orderBy('order','asc'));
        const snap = await getDocs(q); snap.forEach(d=> items.push(d.data()));
      }catch(e){
        const snap = await getDocs(query(col, orderBy('order','asc')));
        snap.forEach(d=>{ const x=d.data(); if(x.published===true) items.push(x); });
      }
      items.forEach(c=>{
        const card = document.createElement('article'); card.className='card';
        const img = c.imageUrl ? `<img src="${c.imageUrl}" alt="${c.title||''}">` : '';
        card.innerHTML = `<div class="case-thumb">${img}</div><div class="case-body"><div class="case-title">${c.title||''}</div><p class="case-sub">${c.subtitle||c.caption||''}</p></div>`;
        list.appendChild(card);
      });
      initCarousel();
    }

    // í›„ê¸°: 4ê°œì”© ë”ë³´ê¸°
    const REVIEWS_PAGE = 4;
    let _reviewDocs = [];
    async function loadReviews(){
      const wrap = document.getElementById('reviews'); if(!wrap) return; wrap.innerHTML='';
      _reviewDocs = [];
      const snap = await getDocs(query(collection(db,'reviews'), orderBy('order','asc')));
      snap.forEach(d=> _reviewDocs.push(d.data()));
      if (_reviewDocs.length === 0) {
        const empty = document.createElement('div'); empty.className='muted'; empty.textContent='ì•„ì§ ë“±ë¡ëœ í›„ê¸°ê°€ ì—†ìŠµë‹ˆë‹¤.'; wrap.appendChild(empty); return;
      }
      renderMoreReviews(true);
    }
    function renderMoreReviews(reset=false){
      const wrap = document.getElementById('reviews'); const moreWrap = document.getElementById('moreReviewsWrap');
      if(reset){ wrap.innerHTML=''; moreWrap.innerHTML=''; renderMoreReviews._i = 0; }
      const start = renderMoreReviews._i || 0;
      const next = _reviewDocs.slice(start, start + REVIEWS_PAGE);
      next.forEach(r=>{
        const title = r.title || 'ê³ ê° í›„ê¸°';
        const body  = (r.bodyHTML || r.bodyHtml || '').trim();
        const img   = (r.imageUrl || '').trim();
        const rating = Number(r.rating || 0);

        const card = document.createElement('article'); card.className='review card';
        card.innerHTML = `
          <div class="thumb">${img ? `<img src="${img}" alt="">` : `ğŸ—¨ï¸`}</div>
          <div class="body">
            <h3 class="title">${title}</h3>
            <p class="meta">${rating ? `<span class="stars">${'â˜…'.repeat(rating)}${'â˜†'.repeat(Math.max(0,5-rating))}</span>` : ''}</p>
            <div class="content">${sanitizeStrict(body)}</div>
          </div>`;
        wrap.appendChild(card);
      });
      renderMoreReviews._i = start + next.length;
      if(renderMoreReviews._i < _reviewDocs.length){
        moreWrap.innerHTML = `<button class="btn alt" id="btnMoreReviews" type="button">í›„ê¸° ë”ë³´ê¸°</button>`;
        document.getElementById('btnMoreReviews').onclick = ()=> renderMoreReviews(false);
      }else{
        moreWrap.innerHTML = '';
      }
    }

    // FAQ (with SVG chevron)
    async function loadFaqs(){
      const list = document.getElementById('faqs'); if(!list) return; list.innerHTML='';
      const snap = await getDocs(query(collection(db,'faqs'), orderBy('order','asc')));
      snap.forEach(d=>{
        const f=d.data();
        const q=(f.q||'').toString();
        const a=(f.aHTML||f.aHtml||'');
        const el=document.createElement('details');
        el.innerHTML = `
          <summary>
            <svg class="faq-caret" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M8 5l8 7-8 7" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>${q}</span>
          </summary>
          <div class="faq-body">${sanitizeStrict(a)}</div>`;
        list.appendChild(el);
      });
    }

    // ===== ë¬¸ì˜: ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì „ì†¡ (GAS) =====
    async function submitToSheet(payload){
      const st = document.getElementById('formStatus');
      st.textContent = 'ì „ì†¡ ì¤‘ì…ë‹ˆë‹¤â€¦';
      const data = {
        date: new Date().toISOString(),
        name: payload.name || '',
        phone: payload.phone || '',
        note: payload.note || ''
      };
      try{
        const res = await fetch(GAS_WEBAPP_URL, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify(data),
          mode:'cors'
        });
        const json = await res.json().catch(()=> ({}));
        if(res.ok && (json.ok !== false)){
          st.textContent = 'ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ë¹ ë¥´ê²Œ ì—°ë½ë“œë¦´ê²Œìš”.';
          document.getElementById('inquiry').reset();
        }else{
          st.textContent = 'ì „ì†¡ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.';
        }
      }catch(e){
        st.textContent = 'ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ì…ë‹ˆë‹¤. ì—°ê²°ì„ í™•ì¸í•´ ì£¼ì„¸ìš”.';
      }
    }
    document.getElementById('inquiry')?.addEventListener('submit', (e)=>{
      e.preventDefault();
      const fd = new FormData(e.currentTarget);
      submitToSheet(Object.fromEntries(fd.entries()));
    });

    // Carousel: drag + auto-slide
    function initCarousel(){
      const track = document.getElementById('caseSlides');
      if(!track) return;

      let isDown=false, startX=0, startScroll=0, paused=false;
      track.addEventListener('pointerdown', e=>{ isDown=true; paused=true; startX=e.clientX; startScroll=track.scrollLeft; track.setPointerCapture(e.pointerId); });
      track.addEventListener('pointermove', e=>{ if(!isDown) return; track.scrollLeft = startScroll - (e.clientX - startX); });
      track.addEventListener('pointerup',   ()=>{ isDown=false; setTimeout(()=>paused=false, 800); });
      track.addEventListener('pointercancel',()=>{ isDown=false; setTimeout(()=>paused=false, 800); });
      track.addEventListener('mouseenter', ()=> paused=true);
      track.addEventListener('mouseleave', ()=> paused=false);

      const step = ()=> {
        if (paused) return;
        const firstCard = track.querySelector('.card');
        if(!firstCard) return;
        const gap = 12;
        const w = firstCard.getBoundingClientRect().width + gap;
        const max = track.scrollWidth - track.clientWidth;
        let next = track.scrollLeft + w;
        if (next > max - 4) {
          track.scrollTo({left:0, behavior:'smooth'});
        } else {
          track.scrollTo({left:next, behavior:'smooth'});
        }
      };
      setInterval(step, 3200);
    }

    // Footer ë°ì´í„° ì±„ìš°ê¸°
    async function applyFooter(){
      try{
        const mainSnap = await getDoc(doc(db,'settings','main'));
        const linksSnap = await getDoc(doc(db,'settings','links'));
        const main = mainSnap.exists() ? mainSnap.data() : {};
        const links = linksSnap.exists() ? linksSnap.data() : {};

        document.getElementById('fPhone').textContent = main.phone || 'â€”';
        const biz = main.businessInfo || {};
        document.getElementById('bizName').textContent  = biz.name  || 'â€”';
        document.getElementById('bizOwner').textContent = biz.owner || 'â€”';
        document.getElementById('bizRegNo').textContent = biz.regNo || 'â€”';
        document.getElementById('bizAddr').textContent  = biz.addr  || 'â€”';
        document.getElementById('bizEtc').textContent   = biz.etc   || 'â€”';

        if (links.blog){ const a=document.getElementById('fBlog'); a.href=links.blog; a.style.display='inline'; }
        if (links.map){  const a=document.getElementById('fMap');  a.href=links.map;  a.style.display='inline'; }
      }catch(e){
        console.log('[footer] settings load fail:', e?.message||e);
      }
    }

    // ì´ˆê¸°í™”
    await loadCases();
    await loadReviews();
    await loadFaqs();
    await applyFooter();
  </script>
</body>
</html>
